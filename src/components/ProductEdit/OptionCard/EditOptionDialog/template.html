<v-dialog v-model="dialog" width="800">
    <v-card>
        <v-card-title class="text-h6 d-flex align-center justify-space-between">
            選項標題
        </v-card-title>

        <v-card-text class="pt-5">
            <v-form ref="form" v-model="valid" lazy-validation>
                <v-text-field :rules="Require" v-model="title" label="選項名稱" dense outlined></v-text-field>
                <div class="d-flex align-center justify-space-between">
                    <p class="text-h6 my-0 black--text">選項內容</p>
                    <v-btn elevation="0" @click="CreateOption" text color="primary">新增選項</v-btn>
                </div>
                <v-divider class="mb-8 mt-3"></v-divider>
                <p v-if="options.length<=0" class="red--text text-center py-0">請至少加入一個選項</p>
                <v-row v-if="type!='color'" style="max-height: 300px;overflow-y: auto;">
                    <v-col cols="12">
                        <v-simple-table>
                            <template v-slot:default>




                                <draggable :list="options" tag="tbody" handle=".page__grab-icon"
                                    @end="drag=false,ChangeSort()">
                                    <tr v-for="(item,item_index) in options" :key="`options_${item_index}`">
                                        <td width="100" class="py-6">
                                            <v-icon small class="page__grab-icon">
                                                mdi-dots-grid
                                            </v-icon>
                                        </td>
                                        <td width="">
                                            <v-text-field :rules="Title" v-model="item.title" :hide-details="true"
                                                :label="`選項${item_index+1}`" dense outlined>
                                            </v-text-field>
                                        </td>
                                        <td width="100">
                                            <v-btn @click=" DeleteOption(item, item_index)" class="mx-2" fab text small
                                                color="error">
                                                <v-icon dark>
                                                    mdi-delete
                                                </v-icon>
                                            </v-btn>
                                        </td>
                                    </tr>
                                </draggable>
                            </template>
                        </v-simple-table>
                    </v-col>
                </v-row>


                <v-row v-else style="max-height: 300px;overflow-y: auto;">
                    <v-col cols="12" v-for="(item,item_index) in options" :key="`options_${item_index}`" class="d-flex">
                        <v-text-field class="mr-1" :rules="Title" v-model="item.title" :label="`選項${item_index+1}_名稱`"
                            dense outlined>
                        </v-text-field>
                        <v-menu ref="menu" :value="menu==item_index" :close-on-click="false"
                            :close-on-content-click="false" transition="scale-transition" offset-y min-width="auto">
                            <template v-slot:activator="{ on, attrs }">
                                <v-text-field class="ml-1" :rules="Require" v-model="item.color"
                                    @click="edit_color = item.color,menu=item_index" :label="`選項${item_index+1}_顏色`"
                                    dense outlined readonly>
                                </v-text-field>
                            </template>
                            <v-color-picker style="border-radius: 0;" dot-size="11" hide-inputs hide-mode-switch
                                mode="hexa" v-model="edit_color" swatches-max-height="173">

                            </v-color-picker>
                            <div class="d-flex white pa-2">
                                <v-spacer></v-spacer>
                                <v-btn text color="primary" @click="menu = -1">
                                    取消
                                </v-btn>
                                <v-btn text color="primary" @click="item.color=edit_color,menu = -1">
                                    確認
                                </v-btn>
                            </div>
                        </v-menu>
                        <v-btn @click=" DeleteOption(item, item_index)" class="mx-2" fab text small color="error">
                            <v-icon dark>
                                mdi-delete
                            </v-icon>
                        </v-btn>
                    </v-col>
                </v-row>

            </v-form>
        </v-card-text>

        <v-divider></v-divider>

        <v-card-actions>
            <v-spacer></v-spacer>
            <v-btn @click="Cancel" color="primary" text>
                取消
            </v-btn>
            <v-btn @click="UpdateOptions" color="primary">
                儲存
            </v-btn>
        </v-card-actions>
    </v-card>
</v-dialog>